# A2A Agent System: Mission Control Vision

## 1. Core Objective

The primary goal is to develop a comprehensive "mission control" dashboard for the A2A (Agent-to-Agent) animation generation system. This dashboard will serve as a central hub for visualizing, debugging, evaluating, and managing the entire pipeline, from user prompt to final animation preview. It aims to provide deep insights into the system's behavior, facilitate rapid iteration, and ultimately improve the quality and reliability of generated animations.

This system is being developed to address challenges in debugging a complex, multi-agent system and to gain a holistic understanding of its internal workings.

## 2. Key Features & Components

### 2.1. Test Environment & Simulation

*   **Test Page (`/test`):** A dedicated page to simulate the production environment's project editing workspace.
*   **User Authentication:** Ensure users can log in to access protected routes and functionalities within the test environment.
*   **Task Submission:** Users (or developers) can submit animation prompts (e.g., "generate a scene with a bouncing ball," "create a Tetris animation") to trigger the A2A pipeline.
*   **Simulation of Production Chat:** The prompt submission should accurately simulate how a real user interacts with the chat interface in the production build.

### 2.2. Agent Interaction Visualization

*   **Agent Dashboard:** A central view displaying all registered agents in the system (e.g., Coordinator, IDL Builder, Code Generator, Validator).
*   **Agent Cards:** Detailed information for each agent, including its capabilities, current status, and responsibilities.
*   **Real-time Communication Animation:** Visually represent interactions between agents. When agents communicate or pass data, this should be animated or highlighted (e.g., connections lighting up, data flows shown).
    *   Color-coding or visual cues based on the Google A2A framework's task types or agent roles.

### 2.3. Animation Design Brief (ADB) Tracking

*   **ADB Display:** Show the generated Animation Design Brief in a readable text format.
*   **ADB Evolution:** Track how the ADB is created, modified, and passed between agents.
*   **Comparative ADBs:** Potentially display multiple ADB versions if different strategies or agents generate them, allowing for comparison.

### 2.4. Code Generation & Custom Component Tracking

*   **Code-Generating Agent Identification:** Clearly indicate which agent is responsible for generating the TSX Remotion code (custom components).
*   **Code Display:** Show the generated custom component code.
*   **Multiple Code Versions:** If the system generates multiple code variations (e.g., from different LLMs or different prompting strategies), display them for comparison.

### 2.5. Evaluation (Eval) Integration

*   **Real-time Eval Display:** Show evaluation metrics and results concurrently as the generation process unfolds.
*   **Eval on Code:** Run evaluations directly on the generated custom code.
*   **Catch Add-ons/Errors:** Integrate with error tracking and display any issues or "add-ons" (unexpected behaviors or outputs) identified during the process.

### 2.6. Remotion Preview & Integration

*   **Embedded Remotion Player:** Include the same RemotionPlayer component used in the production project edit page directly within the test page.
*   **Live Preview:** Every time a custom component is generated, attempt to load and display it in the RemotionPlayer to visually verify its output.
*   **Remotion Index Check:** Verify if the generated code can be successfully integrated into the Remotion ` ร้อยละindex.ts`.
*   **Render Check:** Confirm if the scene can be rendered by Remotion.

### 2.7. Configuration & Experimentation

*   **LLM Model Switching:** Allow easy switching between different LLMs for code generation (e.g., GPT-4, Claude, Gemini) to compare their outputs.
*   **Parameter Adjustment:** Provide controls to adjust various system parameters for experimentation.

### 2.8. Comprehensive Logging & History

*   **Event Timeline:** A chronological log of all significant events, agent interactions, and state changes.
*   **Scene Planner History:** Display the history related to the animation design brief, similar to the production environment.

## 3. User Stories / Workflow

1.  **As a Developer, I want to submit a simple animation prompt (e.g., "bouncing ball") on the `/test` page.**
2.  **I want to see a dashboard light up, showing which agents are activated and how they communicate in response to my prompt.**
3.  **I want to see the Animation Design Brief generated by the relevant agent.**
4.  **I want to see the TSX Remotion code generated for the custom component, and which agent produced it.**
5.  **I want to see this custom component automatically load and play in an embedded Remotion Player on the test page.**
6.  **I want to see evaluation metrics (e.g., code quality, correctness) for the generated code displayed alongside.**
7.  **If there are errors at any stage (ADB generation, code generation, compilation, rendering), I want them to be clearly flagged and detailed.**
8.  **I want to be able to easily switch the underlying LLM used for code generation and re-run the test to compare results.**
9.  **I want a clear visual overview of the entire process, making it easy to identify bottlenecks, errors, or areas for improvement.**

## 4. Technical Considerations

*   **Frontend Framework:** Next.js (as per existing project structure).
*   **UI Components:** Leverage Shadcn UI, Recharts, and other existing UI libraries.
*   **State Management:** Appropriate state management for real-time updates on the dashboard.
*   **Backend Communication:** tRPC for communication with the backend services that drive the A2A pipeline.
*   **Data Persistence:** Store test runs, generated artifacts, and evaluation results in the database (Neon/Postgres via Drizzle ORM).

## 5. Goal & Impact

The successful implementation of this "mission control" system will significantly accelerate the development and refinement of the A2A agent system. It will provide unparalleled visibility into a complex process, enabling more effective debugging, targeted improvements, and confident iteration. This tool is crucial for achieving a robust and intelligent animation generation platform.
