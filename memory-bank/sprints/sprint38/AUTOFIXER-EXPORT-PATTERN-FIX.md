# Autofixer Export Pattern Fix

## Problem
The autofixer was repeatedly failing to fix code that used the incorrect export pattern:
```javascript
// ‚ùå INCORRECT PATTERN (generated by AI):
function Coding() {
  // component code
}
export default Coding;
```

This pattern would fail with compilation errors, but the autofixer wasn't recognizing it as an error to fix.

## Root Cause
1. The FIX_BROKEN_SCENE prompt didn't explicitly mention this specific pattern as a common error
2. The validation logic in fixBrokenScene.ts didn't check for this incorrect pattern
3. The CODE_GENERATOR and IMAGE_TO_CODE prompts weren't explicit enough about the correct export syntax

## Solution Implemented

### 1. Updated FIX_BROKEN_SCENE Prompt
Added explicit section about export patterns:
```
üö® EXPORT DEFAULT PATTERN - CRITICAL:
The ONLY correct export pattern for Remotion components is:
‚úÖ CORRECT: export default function ComponentName() { ... }
‚ùå WRONG: function ComponentName() { ... } export default ComponentName;
```

### 2. Enhanced Validation Logic
Added check for incorrect export pattern in fixBrokenScene.ts:
```javascript
// Check for the incorrect export pattern
const incorrectExportPattern = /function\s+\w+\s*\([^)]*\)\s*{[\s\S]*}\s*export\s+default\s+\w+;?$/;
if (incorrectExportPattern.test(fixedCode.trim())) {
  errors.push('Incorrect export pattern: function declaration should use export default function');
}
```

### 3. Updated Generation Prompts
Enhanced CODE_GENERATOR and IMAGE_TO_CODE prompts to be explicit:
- Added: "export default function {{FUNCTION_NAME}}() - MUST be on the function declaration line"
- Added explicit examples of correct vs incorrect patterns

## Expected Behavior
Now when the autofixer encounters code with the incorrect export pattern:
1. It will recognize it as an error that needs fixing
2. It will surgically change just the export pattern
3. It will preserve all other code exactly as is

## Testing
To test this fix:
1. Generate code that uses the incorrect pattern
2. Trigger the autofixer
3. Verify it changes to: `export default function ComponentName() { ... }`
4. Verify all other code remains unchanged

## Impact
This fix ensures that:
- AI-generated code follows the correct export pattern from the start
- If incorrect patterns slip through, the autofixer can handle them
- Users don't need to manually fix export syntax errors